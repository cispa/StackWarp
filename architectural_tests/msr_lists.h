#ifndef MSR_LISTS_H
#define MSR_LISTS_H
#ifdef __cplusplus
extern "C" {
#endif

struct msr_mask {
    unsigned long msr;
    unsigned long mask;
};

static const struct msr_mask msr_list_lab73_tdx_enabled[] = {
    {0x33, 0x38000000},
    {0x4E, 0x2},
    {0x6C, 0xfffffffffcfc0fc0},
    {0x6D, 0x24084818c00c},
    {0x6E, 0x1ffffffffffff},
    {0x6F, 0xffffffffff},
    {0xA0, 0xffff},
    {0xB1, 0xffffffff},
    {0xE2, 0xffffffffffff840f & ~(1ul << 15)}, // skip lock bit
    {0xE4, 0x7ffff},
    {0x105, 0x200},
    {0x11F, 0xffffffffffffffff},
    {0x178, 0x2},
    {0x17F, 0x11},
    {0x194, 0xfffff},
    {0x19B, 0x1ffff17},
    {0x19C, 0xfffffffffffff800},
    {0x1A0, 0x4000010008},
    {0x1A4, 0x8af},
    {0x1AA, 0x400000},
    {0x1AD, 0xffffffffffffffff},
    {0x1AE, 0xffffffffffffffff},
    {0x1B1, 0xfffffffffffff800},
    {0x1B2, 0x3ffff1f},
    {0x1FC, 0x1fde1fffde},
    // I am leaving the MTRRs alone for now. It seems like Linux does not like me messing with them
    /*{0x200, 0x7fffffffff002},
    {0x201, 0x7fffffffff800},
    {0x202, 0x7fffffffff002},
    {0x203, 0x7fffffffff800},
    {0x204, 0x7fffffffff002},
    {0x205, 0x7fffffffff800},
    {0x206, 0x7fffffffff002},
    {0x207, 0x7fffffffff800},
    {0x208, 0x7fffffffff002},
    {0x209, 0x7fffffffff800},
    {0x20A, 0x7fffffffff002},
    {0x20B, 0x7fffffffff800},
    {0x20C, 0x7fffffffff002},
    {0x20D, 0x7fffffffff800},
    {0x20E, 0x7fffffffff005},
    {0x20F, 0x7fffffffff800},
    {0x210, 0x7fffffffff005},
    {0x211, 0x7fffffffff800},
    {0x212, 0x7fffffffff005},
    {0x213, 0x7fffffffff800},
    {0x250, 0x202020202020202},
    {0x258, 0x202020202020202},
    {0x259, 0x505050505050505},
    {0x268, 0x505050505050505},
    {0x269, 0x505050505050505},
    {0x26A, 0x505050505050505},
    {0x26B, 0x505050505050505},
    {0x26C, 0x505050505050505},
    {0x26D, 0x505050505050505},
    {0x26E, 0x505050505050505},
    {0x26F, 0x505050505050505},*/
    {0x282, 0x40007fff},
    {0x283, 0x40007fff},
    {0x284, 0x40000000},
    {0x285, 0x40007fff},
    {0x286, 0x40007fff},
    {0x287, 0x40007fff},
    {0x288, 0x40007fff},
    {0x289, 0x40007fff},
    {0x28A, 0x40007fff},
    {0x28B, 0x40007fff},
    {0x28C, 0x40007fff},
    {0x28D, 0x40007fff},
    {0x28E, 0x40007fff},
    {0x28F, 0x40007fff},
    {0x290, 0x40007fff},
    {0x291, 0x40007fff},
    {0x292, 0x40007fff},
    {0x293, 0x40007fff},
    {0x294, 0x40007fff},
    {0x295, 0x40007fff},
    {0x296, 0x40007fff},
    {0x297, 0x40007fff},
    {0x298, 0x40007fff},
    {0x299, 0x40007fff},
    {0x29A, 0x40007fff},
    {0x29B, 0x40007fff},
    {0x29C, 0x40007fff},
    {0x29D, 0x40007fff},
    {0x29E, 0x40007fff},
    {0x29F, 0x40007fff},
    {0x2FF, 0xc05}, // MTRR stuff - we stay away
    {0x304, 0xffffffffffffffff},
    // All of these MSRs belong to the machine check architecture.
    // Flipping individual bits here causes a flurry of crashes and errors in Linux and the TDX module, and I have no idea why this might happen.
    // Perhaps we are onto something here. The machine is not completely dead, but in a strange state

    {0x408, 0x1f},
    {0x40C, 0x7f}, // We get segfaults on bit 1 - why?
    {0x410, 0x7},
    {0x414, 0x803f001f},
    {0x418, 0xf},
    {0x424, 0xffffffffff}, // Flip MSR 424 from 0x000000ffffffffff to 0x000000fffffff7ff -> TDX Module Crash
    {0x428, 0xffffffffff},
    {0x42C, 0xffffffffff}, // Mask 0x0000000040000000 killed us - why?
    {0x430, 0xfff3},
    {0x434, 0x3fffffffffffffff},
    {0x438, 0x3fffffffffffffff},
    {0x43C, 0x3fffffffffffffff},
    {0x440, 0x3fffffffffffffff},
    {0x444, 0x3fffffffffffffff},
    {0x448, 0x3fffffffffffffff},
    {0x44C, 0x3fffffffffffffff},
    {0x450, 0x3fffffffffffffff},

    {0x541, 0x1},
    {0x571, 0x4000000000},
    {0x601, 0x7fffffff00000000},
    {0x603, 0x1fffffffffffff},
    {0x60A, 0x9fff},
    {0x60B, 0x9fff},
    {0x60C, 0x9fff},
    {0x610, 0x80ffffff00ff7fff & ~(1ul << 63)}, // skip lock bit
    {0x611, 0xffffffffffff8000},
    {0x612, 0xfffffbfffffffc00},
    {0x618, 0x8000000000feffff & ~(1ul << 31)}, // skip lock bit
    {0x619, 0xffffffffff800000},
    {0x620, 0x7f7f},
    {0x638, 0xffffffff80ffffff & ~(1ul << 31)}, // skip lock bit
    {0x64C, 0xff},
    // {0x64D, 0xffffffffffffe000}, // RAPL
    {0x64F, 0xfffffffffffc0000},
    {0x65C, 0x83ffffff03ffffff},
    {0x71C, 0xffffffffffffffff},
    {0xA00, 0x13f},
    {0xA01, 0xfffff07f},
    {0xA02, 0xdfffdfff},
    {0xC70, 0x7fffffc000000},
    {0xC71, 0x7fffffc000000},
    {0xC72, 0x7fffffc000000},
    {0xC73, 0x7fffffc000000},
    {0xC74, 0x7fffffc000000},
    {0xC75, 0x7fffffc000000},
    {0xC76, 0x7fffffc000000},
    {0xC77, 0x7fffffc000000},
    {0xC78, 0x7fffffc000000},
    {0xC79, 0x7fffffc000000},
    {0xC7A, 0x7fffffc000000},
    {0xC7B, 0x7fffffc000000},
    {0xC7C, 0x7fffffc000000},
    {0xC7D, 0x7fffffc000000},
    {0xC7E, 0x7fffffc000000},
    {0xC7F, 0x7fffffc000000},
    {0xC81, 0x1},
    {0xC82, 0x1},
    {0xC83, 0x1},
    {0xC84, 0x3},
    {0xC85, 0x7fff},
    {0xC86, 0x3},
    {0xC8B, 0x9000},
    {0xC90, 0x4001},
    {0xC91, 0x4001},
    {0xC92, 0x4001},
    {0xC93, 0x4001},
    {0xC94, 0x4001},
    {0xC95, 0x4001},
    {0xC96, 0x4001},
    {0xC97, 0x4001},
    {0xC98, 0x4001},
    {0xC99, 0x4001},
    {0xC9A, 0x4001},
    {0xC9B, 0x4001},
    {0xC9C, 0x4001},
    {0xC9D, 0x4001},
    {0xC9E, 0x4001},
    {0xCA0, 0x1},
    {0xCA1, 0xffffffff},
    {0xD10, 0x8001},
    {0xD11, 0x8001},
    {0xD12, 0x8001},
    {0xD13, 0x8001},
    {0xD14, 0x8001},
    {0xD15, 0x8001},
    {0xD16, 0x8001},
    {0xD17, 0x8001},
    {0xD50, 0x70},
    {0xD51, 0x70},
    {0xD52, 0x70},
    {0xD53, 0x70},
    {0xD54, 0x70},
    {0xD55, 0x70},
    {0xD56, 0x70},
    {0xD57, 0x70},
    {0xD58, 0x70},
    {0xD59, 0x70},
    {0xD5A, 0x70},
    {0xD5B, 0x70},
    {0xD5C, 0x70},
    {0xD5D, 0x70},
    {0xD5E, 0x70},
    {0x17D0, 0x7fffffffff001},
    {0x17D1, 0x1},

    {0x1890, 0x3000001},
    {0x1891, 0x3000001},
    {0x1892, 0x3000001},
    {0x1893, 0x3000001},
    {0x1894, 0x3000001},
    {0x1895, 0x3000001},
    {0x1896, 0x3000001},
    {0x1897, 0x3000001},
    {0x1898, 0x3000001},
    {0x1899, 0x3000001},
    {0x189A, 0x3000001},
    {0x189B, 0x3000001},
    {0x189C, 0x3000001},
    {0x189D, 0x3000001},
    {0x189E, 0x3000001},

    {0x1A90, 0x81},
    {0x1A91, 0x81},
    {0x1A92, 0x81},
    {0x1A93, 0x81},
    {0x1A94, 0x81},
    {0x1A95, 0x81},
    {0x1A96, 0x81},
    {0x1A97, 0x81},
    {0x2000, 0x1},
    {0x2002, 0xffffffffff95ffff},
    {0x2003, 0xffffffffff95ffff},
    {0x2004, 0xffffffffff95ffff},
    {0x2005, 0xffffffffff95ffff},
    {0x2008, 0xffffffffffff},
    {0x2009, 0xffffffffffff},
    {0x200A, 0xffffffffffff},
    {0x200B, 0xffffffffffff},
    {0x200E, 0x3ff},
    {0x2010, 0x1},
    {0x2012, 0xffffffffff95ffff},
    {0x2013, 0xffffffffff95ffff},
    {0x2014, 0xffffffffff95ffff},
    {0x2015, 0xffffffffff95ffff},
    {0x2018, 0xffffffffffff},
    {0x2019, 0xffffffffffff},
    {0x201A, 0xffffffffffff},
    {0x201B, 0xffffffffffff},
    {0x201E, 0x3ff},
    {0x2020, 0x1},
    {0x2022, 0xffffffffff95ffff},
    {0x2023, 0xffffffffff95ffff},
    {0x2024, 0xffffffffff95ffff},
    {0x2025, 0xffffffffff95ffff},
    {0x2028, 0xffffffffffff},
    {0x2029, 0xffffffffffff},
    {0x202A, 0xffffffffffff},
    {0x202B, 0xffffffffffff},
    {0x202E, 0x3ff},
    {0x2030, 0x1},
    {0x2032, 0xffffffffff95ffff},
    {0x2033, 0xffffffffff95ffff},
    {0x2034, 0xffffffffff95ffff},
    {0x2035, 0xffffffffff95ffff},
    {0x2038, 0xffffffffffff},
    {0x2039, 0xffffffffffff},
    {0x203A, 0xffffffffffff},
    {0x203B, 0xffffffffffff},
    {0x203E, 0x3ff},
    {0x2040, 0x1},
    {0x2042, 0xffffffffff95ffff},
    {0x2043, 0xffffffffff95ffff},
    {0x2044, 0xffffffffff95ffff},
    {0x2045, 0xffffffffff95ffff},
    {0x2048, 0xffffffffffff},
    {0x2049, 0xffffffffffff},
    {0x204A, 0xffffffffffff},
    {0x204B, 0xffffffffffff},
    {0x204E, 0x3ff},
    {0x2050, 0x1},
    {0x2052, 0xffffffffff95ffff},
    {0x2053, 0xffffffffff95ffff},
    {0x2054, 0xffffffffff95ffff},
    {0x2055, 0xffffffffff95ffff},
    {0x2058, 0xffffffffffff},
    {0x2059, 0xffffffffffff},
    {0x205A, 0xffffffffffff},
    {0x205B, 0xffffffffffff},
    {0x205E, 0x3ff},
    {0x2060, 0x1},
    {0x2062, 0xffffffffff95ffff},
    {0x2063, 0xffffffffff95ffff},
    {0x2064, 0xffffffffff95ffff},
    {0x2065, 0xffffffffff95ffff},
    {0x2068, 0xffffffffffff},
    {0x2069, 0xffffffffffff},
    {0x206A, 0xffffffffffff},
    {0x206B, 0xffffffffffff},
    {0x206E, 0x3ff},
    {0x2070, 0x1},
    {0x2072, 0xffffffffff95ffff},
    {0x2073, 0xffffffffff95ffff},
    {0x2074, 0xffffffffff95ffff},
    {0x2075, 0xffffffffff95ffff},
    {0x2078, 0xffffffffffff},
    {0x2079, 0xffffffffffff},
    {0x207A, 0xffffffffffff},
    {0x207B, 0xffffffffffff},
    {0x207E, 0x3ff},
    {0x2080, 0x1},
    {0x2082, 0xffffffffff95ffff},
    {0x2083, 0xffffffffff95ffff},
    {0x2084, 0xffffffffff95ffff},
    {0x2085, 0xffffffffff95ffff},
    {0x2088, 0xffffffffffff},
    {0x2089, 0xffffffffffff},
    {0x208A, 0xffffffffffff},
    {0x208B, 0xffffffffffff},
    {0x208E, 0x3ff},
    {0x2090, 0x1},
    {0x2092, 0xffffffffff95ffff},
    {0x2093, 0xffffffffff95ffff},
    {0x2094, 0xffffffffff95ffff},
    {0x2095, 0xffffffffff95ffff},
    {0x2098, 0xffffffffffff},
    {0x2099, 0xffffffffffff},
    {0x209A, 0xffffffffffff},
    {0x209B, 0xffffffffffff},
    {0x209E, 0x3ff},
    {0x20A0, 0x1},
    {0x20A2, 0xffffffffff95ffff},
    {0x20A3, 0xffffffffff95ffff},
    {0x20A4, 0xffffffffff95ffff},
    {0x20A5, 0xffffffffff95ffff},
    {0x20A8, 0xffffffffffff},
    {0x20A9, 0xffffffffffff},
    {0x20AA, 0xffffffffffff},
    {0x20AB, 0xffffffffffff},
    {0x20AE, 0x3ff},
    {0x20B0, 0x1},
    {0x20B2, 0xffffffffff95ffff},
    {0x20B3, 0xffffffffff95ffff},
    {0x20B4, 0xffffffffff95ffff},
    {0x20B5, 0xffffffffff95ffff},
    {0x20B8, 0xffffffffffff},
    {0x20B9, 0xffffffffffff},
    {0x20BA, 0xffffffffffff},
    {0x20BB, 0xffffffffffff},
    {0x20BE, 0x3ff},
    {0x20C0, 0x1},
    {0x20C2, 0xffffffffff95ffff},
    {0x20C3, 0xffffffffff95ffff},
    {0x20C4, 0xffffffffff95ffff},
    {0x20C5, 0xffffffffff95ffff},
    {0x20C8, 0xffffffffffff},
    {0x20C9, 0xffffffffffff},
    {0x20CA, 0xffffffffffff},
    {0x20CB, 0xffffffffffff},
    {0x20CE, 0x3ff},
    {0x20D0, 0x1},
    {0x20D2, 0xffffffffff95ffff},
    {0x20D3, 0xffffffffff95ffff},
    {0x20D4, 0xffffffffff95ffff},
    {0x20D5, 0xffffffffff95ffff},
    {0x20D8, 0xffffffffffff},
    {0x20D9, 0xffffffffffff},
    {0x20DA, 0xffffffffffff},
    {0x20DB, 0xffffffffffff},
    {0x20DE, 0x3ff},
    {0x20E0, 0x1},
    {0x20E2, 0xffffffffff95ffff},
    {0x20E3, 0xffffffffff95ffff},
    {0x20E4, 0xffffffffff95ffff},
    {0x20E5, 0xffffffffff95ffff},
    {0x20E8, 0xffffffffffff},
    {0x20E9, 0xffffffffffff},
    {0x20EA, 0xffffffffffff},
    {0x20EB, 0xffffffffffff},
    {0x20EE, 0x3ff},
    {0x20F0, 0x1},
    {0x20F2, 0xffffffffff95ffff},
    {0x20F3, 0xffffffffff95ffff},
    {0x20F4, 0xffffffffff95ffff},
    {0x20F5, 0xffffffffff95ffff},
    {0x20F8, 0xffffffffffff},
    {0x20F9, 0xffffffffffff},
    {0x20FA, 0xffffffffffff},
    {0x20FB, 0xffffffffffff},
    {0x20FE, 0x3ff},
    {0x2100, 0x1},
    {0x2102, 0xffffffffff95ffff},
    {0x2103, 0xffffffffff95ffff},
    {0x2104, 0xffffffffff95ffff},
    {0x2105, 0xffffffffff95ffff},
    {0x2108, 0xffffffffffff},
    {0x2109, 0xffffffffffff},
    {0x210A, 0xffffffffffff},
    {0x210B, 0xffffffffffff},
    {0x210E, 0x3ff},
    {0x2110, 0x1},
    {0x2112, 0xffffffffff95ffff},
    {0x2113, 0xffffffffff95ffff},
    {0x2114, 0xffffffffff95ffff},
    {0x2115, 0xffffffffff95ffff},
    {0x2118, 0xffffffffffff},
    {0x2119, 0xffffffffffff},
    {0x211A, 0xffffffffffff},
    {0x211B, 0xffffffffffff},
    {0x211E, 0x3ff},
    {0x2120, 0x1},
    {0x2122, 0xffffffffff95ffff},
    {0x2123, 0xffffffffff95ffff},
    {0x2124, 0xffffffffff95ffff},
    {0x2125, 0xffffffffff95ffff},
    {0x2128, 0xffffffffffff},
    {0x2129, 0xffffffffffff},
    {0x212A, 0xffffffffffff},
    {0x212B, 0xffffffffffff},
    {0x212E, 0x3ff},
    {0x2130, 0x1},
    {0x2132, 0xffffffffff95ffff},
    {0x2133, 0xffffffffff95ffff},
    {0x2134, 0xffffffffff95ffff},
    {0x2135, 0xffffffffff95ffff},
    {0x2138, 0xffffffffffff},
    {0x2139, 0xffffffffffff},
    {0x213A, 0xffffffffffff},
    {0x213B, 0xffffffffffff},
    {0x213E, 0x3ff},
    {0x2140, 0x1},
    {0x2142, 0xffffffffff95ffff},
    {0x2143, 0xffffffffff95ffff},
    {0x2144, 0xffffffffff95ffff},
    {0x2145, 0xffffffffff95ffff},
    {0x2148, 0xffffffffffff},
    {0x2149, 0xffffffffffff},
    {0x214A, 0xffffffffffff},
    {0x214B, 0xffffffffffff},
    {0x214E, 0x3ff},
    {0x2150, 0x1},
    {0x2152, 0xffffffffff95ffff},
    {0x2153, 0xffffffffff95ffff},
    {0x2154, 0xffffffffff95ffff},
    {0x2155, 0xffffffffff95ffff},
    {0x2158, 0xffffffffffff},
    {0x2159, 0xffffffffffff},
    {0x215A, 0xffffffffffff},
    {0x215B, 0xffffffffffff},
    {0x215E, 0x3ff},
    {0x2160, 0x1},
    {0x2162, 0xffffffffff95ffff},
    {0x2163, 0xffffffffff95ffff},
    {0x2164, 0xffffffffff95ffff},
    {0x2165, 0xffffffffff95ffff},
    {0x2168, 0xffffffffffff},
    {0x2169, 0xffffffffffff},
    {0x216A, 0xffffffffffff},
    {0x216B, 0xffffffffffff},
    {0x216E, 0x3ff},
    {0x2170, 0x1},
    {0x2172, 0xffffffffff95ffff},
    {0x2173, 0xffffffffff95ffff},
    {0x2174, 0xffffffffff95ffff},
    {0x2175, 0xffffffffff95ffff},
    {0x2178, 0xffffffffffff},
    {0x2179, 0xffffffffffff},
    {0x217A, 0xffffffffffff},
    {0x217B, 0xffffffffffff},
    {0x217E, 0x3ff},
    {0x2180, 0x1},
    {0x2182, 0xffffffffff95ffff},
    {0x2183, 0xffffffffff95ffff},
    {0x2184, 0xffffffffff95ffff},
    {0x2185, 0xffffffffff95ffff},
    {0x2188, 0xffffffffffff},
    {0x2189, 0xffffffffffff},
    {0x218A, 0xffffffffffff},
    {0x218B, 0xffffffffffff},
    {0x218E, 0x3ff},
    {0x2190, 0x1},
    {0x2192, 0xffffffffff95ffff},
    {0x2193, 0xffffffffff95ffff},
    {0x2194, 0xffffffffff95ffff},
    {0x2195, 0xffffffffff95ffff},
    {0x2198, 0xffffffffffff},
    {0x2199, 0xffffffffffff},
    {0x219A, 0xffffffffffff},
    {0x219B, 0xffffffffffff},
    {0x219E, 0x3ff},
    {0x21A0, 0x1},
    {0x21A2, 0xffffffffff95ffff},
    {0x21A3, 0xffffffffff95ffff},
    {0x21A4, 0xffffffffff95ffff},
    {0x21A5, 0xffffffffff95ffff},
    {0x21A8, 0xffffffffffff},
    {0x21A9, 0xffffffffffff},
    {0x21AA, 0xffffffffffff},
    {0x21AB, 0xffffffffffff},
    {0x21AE, 0x3ff},
    {0x21B0, 0x1},
    {0x21B2, 0xffffffffff95ffff},
    {0x21B3, 0xffffffffff95ffff},
    {0x21B4, 0xffffffffff95ffff},
    {0x21B5, 0xffffffffff95ffff},
    {0x21B8, 0xffffffffffff},
    {0x21B9, 0xffffffffffff},
    {0x21BA, 0xffffffffffff},
    {0x21BB, 0xffffffffffff},
    {0x21BE, 0x3ff},
    {0x21C0, 0x1},
    {0x21C2, 0xffffffffff95ffff},
    {0x21C3, 0xffffffffff95ffff},
    {0x21C4, 0xffffffffff95ffff},
    {0x21C5, 0xffffffffff95ffff},
    {0x21C8, 0xffffffffffff},
    {0x21C9, 0xffffffffffff},
    {0x21CA, 0xffffffffffff},
    {0x21CB, 0xffffffffffff},
    {0x21CE, 0x3ff},
    {0x21D0, 0x1},
    {0x21D2, 0xffffffffff95ffff},
    {0x21D3, 0xffffffffff95ffff},
    {0x21D4, 0xffffffffff95ffff},
    {0x21D5, 0xffffffffff95ffff},
    {0x21D8, 0xffffffffffff},
    {0x21D9, 0xffffffffffff},
    {0x21DA, 0xffffffffffff},
    {0x21DB, 0xffffffffffff},
    {0x21DE, 0x3ff},
    {0x21E0, 0x1},
    {0x21E2, 0xffffffffff95ffff},
    {0x21E3, 0xffffffffff95ffff},
    {0x21E4, 0xffffffffff95ffff},
    {0x21E5, 0xffffffffff95ffff},
    {0x21E8, 0xffffffffffff},
    {0x21E9, 0xffffffffffff},
    {0x21EA, 0xffffffffffff},
    {0x21EB, 0xffffffffffff},
    {0x21EE, 0x3ff},
    {0x21F0, 0x1},
    {0x21F2, 0xffffffffff95ffff},
    {0x21F3, 0xffffffffff95ffff},
    {0x21F4, 0xffffffffff95ffff},
    {0x21F5, 0xffffffffff95ffff},
    {0x21F8, 0xffffffffffff},
    {0x21F9, 0xffffffffffff},
    {0x21FA, 0xffffffffffff},
    {0x21FB, 0xffffffffffff},
    {0x21FE, 0x3ff},
    {0x2200, 0x1},
    {0x2202, 0xffffffffff95ffff},
    {0x2203, 0xffffffffff95ffff},
    {0x2204, 0xffffffffff95ffff},
    {0x2205, 0xffffffffff95ffff},
    {0x2208, 0xffffffffffff},
    {0x2209, 0xffffffffffff},
    {0x220A, 0xffffffffffff},
    {0x220B, 0xffffffffffff},
    {0x220E, 0x3ff},
    {0x2210, 0x1},
    {0x2212, 0xffffffffff95ffff},
    {0x2213, 0xffffffffff95ffff},
    {0x2214, 0xffffffffff95ffff},
    {0x2215, 0xffffffffff95ffff},
    {0x2218, 0xffffffffffff},
    {0x2219, 0xffffffffffff},
    {0x221A, 0xffffffffffff},
    {0x221B, 0xffffffffffff},
    {0x221E, 0x3ff},
    {0x2FC0, 0x1},
    {0x2FC2, 0xbc00ffff9400ff},
    {0x2FC3, 0xff9400ff},
    {0x2FC4, 0xbc00ffff9400ff},
    {0x2FC5, 0xff9400ff},
    {0x2FC8, 0xffffffffffff},
    {0x2FC9, 0xffffffffffff},
    {0x2FCA, 0xffffffffffff},
    {0x2FCB, 0xffffffffffff},
    {0x2FCE, 0xffffffff},
    {0x2FD0, 0xffffffffffffff01},
    {0x2FD2, 0xff96ffff},
    {0x2FD3, 0xff96ffff},
    {0x2FD8, 0xffffffffffff},
    {0x2FD9, 0xffffffffffff},
    {0x2FDE, 0x500000},
    {0x2FDF, 0xffffffffffff},
    {0x2FF0, 0x300},
    {0x2FF1, 0xffffffffffffffff},
    {0x2FFB, 0x1ffffff},
    {0x2FFC, 0xfffffff},
    {0x2FFD, 0xffff},
    {0x2FFF, 0xf},
    {0x3000, 0x1},
    {0x3002, 0x7ffffff94ffff},
    {0x3003, 0x7ffffff94ffff},
    {0x3004, 0x7ffffff94ffff},
    {0x3005, 0x7ffffff94ffff},
    {0x3008, 0xffffffffffff},
    {0x3009, 0xffffffffffff},
    {0x300A, 0xffffffffffff},
    {0x300B, 0xffffffffffff},
    {0x3010, 0x1},
    {0x3012, 0x7ffffff94ffff},
    {0x3013, 0x7ffffff94ffff},
    {0x3014, 0x7ffffff94ffff},
    {0x3015, 0x7ffffff94ffff},
    {0x3018, 0xffffffffffff},
    {0x3019, 0xffffffffffff},
    {0x301A, 0xffffffffffff},
    {0x301B, 0xffffffffffff},
    {0x3020, 0x1},
    {0x3022, 0x7ffffff94ffff},
    {0x3023, 0x7ffffff94ffff},
    {0x3024, 0x7ffffff94ffff},
    {0x3025, 0x7ffffff94ffff},
    {0x3028, 0xffffffffffff},
    {0x3029, 0xffffffffffff},
    {0x302A, 0xffffffffffff},
    {0x302B, 0xffffffffffff},
    {0x3030, 0x1},
    {0x3032, 0x7ffffff94ffff},
    {0x3033, 0x7ffffff94ffff},
    {0x3034, 0x7ffffff94ffff},
    {0x3035, 0x7ffffff94ffff},
    {0x3038, 0xffffffffffff},
    {0x3039, 0xffffffffffff},
    {0x303A, 0xffffffffffff},
    {0x303B, 0xffffffffffff},
    {0x3040, 0x1},
    {0x3042, 0x7ffffff94ffff},
    {0x3043, 0x7ffffff94ffff},
    {0x3044, 0x7ffffff94ffff},
    {0x3045, 0x7ffffff94ffff},
    {0x3048, 0xffffffffffff},
    {0x3049, 0xffffffffffff},
    {0x304A, 0xffffffffffff},
    {0x304B, 0xffffffffffff},
    {0x3050, 0x1},
    {0x3052, 0x7ffffff94ffff},
    {0x3053, 0x7ffffff94ffff},
    {0x3054, 0x7ffffff94ffff},
    {0x3055, 0x7ffffff94ffff},
    {0x3058, 0xffffffffffff},
    {0x3059, 0xffffffffffff},
    {0x305A, 0xffffffffffff},
    {0x305B, 0xffffffffffff},
    {0x30A0, 0x1},
    {0x30A2, 0x7ffffff94ffff},
    {0x30A3, 0x7ffffff94ffff},
    {0x30A4, 0x7ffffff94ffff},
    {0x30A5, 0x7ffffff94ffff},
    {0x30A8, 0xffffffffffff},
    {0x30A9, 0xffffffffffff},
    {0x30AA, 0xffffffffffff},
    {0x30AB, 0xffffffffffff},
    {0x3200, 0x1},
    {0x3202, 0xb4ffffff94ffff},
    {0x3203, 0xff94ffff},
    {0x3204, 0xb4ffffff94ffff},
    {0x3205, 0xff94ffff},
    {0x3208, 0xffffffffffff},
    {0x3209, 0xffffffffffff},
    {0x320A, 0xffffffffffff},
    {0x320B, 0xffffffffffff},
    {0x3210, 0x1},
    {0x3212, 0xb4ffffff94ffff},
    {0x3213, 0xff94ffff},
    {0x3214, 0xb4ffffff94ffff},
    {0x3215, 0xff94ffff},
    {0x3218, 0xffffffffffff},
    {0x3219, 0xffffffffffff},
    {0x321A, 0xffffffffffff},
    {0x321B, 0xffffffffffff},
    {0x3220, 0x1},
    {0x3222, 0xb4ffffff94ffff},
    {0x3223, 0xff94ffff},
    {0x3224, 0xb4ffffff94ffff},
    {0x3225, 0xff94ffff},
    {0x3228, 0xffffffffffff},
    {0x3229, 0xffffffffffff},
    {0x322A, 0xffffffffffff},
    {0x322B, 0xffffffffffff},
    {0x3230, 0x1},
    {0x3232, 0xb4ffffff94ffff},
    {0x3233, 0xff94ffff},
    {0x3234, 0xb4ffffff94ffff},
    {0x3235, 0xff94ffff},
    {0x3238, 0xffffffffffff},
    {0x3239, 0xffffffffffff},
    {0x323A, 0xffffffffffff},
    {0x323B, 0xffffffffffff},
    {0x3240, 0x1},
    {0x3242, 0xb4ffffff94ffff},
    {0x3243, 0xff94ffff},
    {0x3244, 0xb4ffffff94ffff},
    {0x3245, 0xff94ffff},
    {0x3248, 0xffffffffffff},
    {0x3249, 0xffffffffffff},
    {0x324A, 0xffffffffffff},
    {0x324B, 0xffffffffffff},
    {0x3250, 0x1},
    {0x3252, 0xb4ffffff94ffff},
    {0x3253, 0xff94ffff},
    {0x3254, 0xb4ffffff94ffff},
    {0x3255, 0xff94ffff},
    {0x3258, 0xffffffffffff},
    {0x3259, 0xffffffffffff},
    {0x325A, 0xffffffffffff},
    {0x325B, 0xffffffffffff},
    {0x32A0, 0x1},
    {0x32A2, 0xb4ffffff94ffff},
    {0x32A3, 0xff94ffff},
    {0x32A4, 0xb4ffffff94ffff},
    {0x32A5, 0xff94ffff},
    {0x32A8, 0xffffffffffff},
    {0x32A9, 0xffffffffffff},
    {0x32AA, 0xffffffffffff},
    {0x32AB, 0xffffffffffff},
    {0x3400, 0x1},
    {0x3402, 0xb4ffffff94ffff},
    {0x3403, 0xff94ffff},
    {0x3408, 0xffffffffffff},
    {0x3409, 0xffffffffffff},
    {0x3410, 0x1},
    {0x3412, 0xb4ffffff94ffff},
    {0x3413, 0xff94ffff},
    {0x3418, 0xffffffffffff},
    {0x3419, 0xffffffffffff},
    {0x3420, 0x1},
    {0x3422, 0xb4ffffff94ffff},
    {0x3423, 0xff94ffff},
    {0x3428, 0xffffffffffff},
    {0x3429, 0xffffffffffff},
    {0x3430, 0x1},
    {0x3432, 0xb4ffffff94ffff},
    {0x3433, 0xff94ffff},
    {0x3438, 0xffffffffffff},
    {0x3439, 0xffffffffffff},
    {0x3440, 0x1},
    {0x3442, 0xb4ffffff94ffff},
    {0x3443, 0xff94ffff},
    {0x3448, 0xffffffffffff},
    {0x3449, 0xffffffffffff},
    {0x3450, 0x1},
    {0x3452, 0xb4ffffff94ffff},
    {0x3453, 0xff94ffff},
    {0x3458, 0xffffffffffff},
    {0x3459, 0xffffffffffff},
    {0x34A0, 0x1},
    {0x34A2, 0xb4ffffff94ffff},
    {0x34A3, 0xff94ffff},
    {0x34A8, 0xffffffffffff},
    {0x34A9, 0xffffffffffff},
    {0xC0000103, 0x10},
};

// We observe crashes if we jitter the bits in these masks
// Bits 1, 2 and 6 of 0x1a4 induce a weird state when flipped quickly, which crashes Linux and persists across reboots
// Disconnect power cable from lab73 for a few seconds to fix
static const struct msr_mask jitter_blacklist[] = {
    {0x1a0, ~0x0000004000010008ul},
    {0x1a4, 0x2b},
    // {0x2ff, 0xc06},
    {0x769, 0xfffffffffff},
    {0x770, 0xffffffffffffffff},
};

static const unsigned int perma_set_1_blacklist[] = {
    0x1a0,
};

static const unsigned int perma_set_0_blacklist[] = {
    0x1a0,
};

static const unsigned int buggy_flip_blacklist[] = {
    0x1a0,
};


static const struct msr_mask msr_subjects[] = {
    //{0x1a4, 0x8af},
    // {0x1a4, 0x80f},

    {0x1890, 0x3000001},
    /*{0x1891, 0x3000001},
    {0x1892, 0x3000001},
    {0x1893, 0x3000001},
    {0x1894, 0x3000001},
    {0x1895, 0x3000001},
    {0x1896, 0x3000001},
    {0x1897, 0x3000001},
    {0x1898, 0x3000001},
    {0x1899, 0x3000001},
    {0x189A, 0x3000001},
    {0x189B, 0x3000001},
    {0x189C, 0x3000001},
    {0x189D, 0x3000001},
    {0x189E, 0x3000001},*/
};

static const struct msr_mask msr_list_lab61[] = {
    {0x0, 0xfff},
    {0x33, 0x80000000},
    {0x95, 0x1},
    {0xE2, 0xfe00040f & ~(1ul << 15)},
    {0xE4, 0x7ffff},
    {0x102, 0x80007fff},
    {0x103, 0xff},
    {0x11F, 0xffffffffffffffff},
    {0x150, 0x8000000000000000},
    {0x194, 0xfffffffffff1ffff},
    {0x198, 0xf7fffffdffff7fee},
    {0x19B, 0x1ffff17},
    {0x1A0, 0x4000010008}, // Crashes
    {0x1A2, 0xffffffffbf0000ff},
    {0x1A4, 0x80f},
    {0x1AA, 0x401481},
    {0x1B2, 0x1ffff17},
    {0x1FC, 0xffffffffffffffdf},
    /* Evil MTRR stuff
    {0x200, 0x7ffffff005},
    {0x201, 0x7ffffff800},
    {0x202, 0x7ffffff005},
    {0x203, 0x7ffffff800},
    {0x204, 0x7ffffff005},
    {0x205, 0x7ffffff800},
    {0x206, 0x7ffffff005},
    {0x207, 0x7ffffff800},
    {0x208, 0x7ffffff005},
    {0x209, 0x7ffffff800},
    {0x20A, 0x7ffffff005},
    {0x20B, 0x7ffffff800},
    {0x20C, 0x7ffffff005},
    {0x20D, 0x7ffffff800},
    {0x20E, 0x7ffffff005},
    {0x20F, 0x7ffffff800},
    {0x210, 0x7ffffff005},
    {0x211, 0x7ffffff800},
    {0x212, 0x7ffffff005},
    {0x213, 0x7ffffff800},
    */
    {0x250, 0x202020202020202},
    {0x258, 0x202020202020202},
    {0x259, 0x505050505050505},
    {0x268, 0x505050505050505},
    {0x269, 0x505050505050505},
    {0x26A, 0x505050505050505},
    {0x26B, 0x505050505050505},
    {0x26C, 0x505050505050505},
    {0x26D, 0x505050505050505},
    {0x26E, 0x505050505050505},
    {0x26F, 0x505050505050505},
    {0x280, 0x40007fff},
    {0x281, 0x40007fff},
    {0x282, 0x40007fff},
    {0x283, 0x40007fff},
    {0x286, 0x40007fff},
    {0x287, 0x40007fff},
    {0x288, 0x40007fff},
    {0x289, 0x40007fff},
    {0x28A, 0x40007fff},
    {0x28B, 0x40007fff},
    {0x2FF, 0xc02}, // MTRR
    {0x302, 0xfffffffffffe0000},
    {0x394, 0x500000},
    {0x395, 0xffffffffffff},
    {0x397, 0xf},
    {0x3B0, 0xfffffffffff},
    {0x3B1, 0xfffffffffff},
    {0x3B2, 0x1fdcffff},
    {0x3B3, 0x1fdcffff},

    {0x400, 0xfff},
    {0x404, 0xf},
    {0x408, 0xf},
    {0x40C, 0x1f},
    {0x410, 0x3f},
    {0x414, 0x1},
    {0x418, 0xff},
    {0x41C, 0xff},
    {0x420, 0xff},
    {0x424, 0xff},
    {0x428, 0xff},
    {0x42C, 0xff},

    {0x4E2, 0xffffffffffffff86},
    {0x561, 0x4000000000},
    {0x571, 0x1000000000},
    {0x601, 0xffffffff80001fff},
    {0x603, 0x7fffffffffffff},
    {0x607, 0x1fffffff},
    {0x608, 0xffffffff},
    {0x60A, 0x9fff},
    {0x60B, 0x9fff},
    {0x60C, 0x9fff},
    {0x610, 0x80ffffff00ff7fff & ~(1ul << 63)},
    {0x611, 0xff80000000000000},
    {0x620, 0x7f7f},
    {0x622, 0x1},
    {0x633, 0x9fff},
    {0x634, 0x9fff},
    {0x635, 0x9fff},
    {0x636, 0xffff},
    {0x638, 0xffffffff80ffffff & ~(1ul << 31)},
    {0x639, 0xfbfb7feffdbffdbe},
    {0x63A, 0x1f},
    {0x640, 0xffffffff80ffffff},
    {0x642, 0x1f},
    {0x64F, 0xfffffffff0000000},
    {0x652, 0x7fff7ff},
    {0x65C, 0x8001ffff00ffffff},
    {0x700, 0x1fdcffff},
    {0x701, 0x1fdcffff},
    {0x702, 0x1fdcffff},
    {0x703, 0x1fdcffff},
    {0x704, 0xf},
    {0x706, 0xfffffffffff},
    {0x707, 0xfffffffffff},
    {0x708, 0xfffffffffff},
    {0x709, 0xfffffffffff},
    {0x710, 0x1fdcffff},
    {0x711, 0x1fdcffff},
    {0x712, 0x1fdcffff},
    {0x713, 0x1fdcffff},
    {0x714, 0xf},
    {0x716, 0xfffffffffff},
    {0x717, 0xfffffffffff},
    {0x718, 0xfffffffffff},
    {0x719, 0xfffffffffff},
    {0x720, 0x1fdcffff},
    {0x721, 0x1fdcffff},
    {0x722, 0x1fdcffff},
    {0x723, 0x1fdcffff},
    {0x724, 0xf},
    {0x726, 0xfffffffffff},
    {0x727, 0xfffffffffff},
    {0x728, 0xfffffffffff},
    {0x729, 0xfffffffffff},
    {0x730, 0x1fdcffff},
    {0x731, 0x1fdcffff},
    {0x732, 0x1fdcffff},
    {0x733, 0x1fdcffff},
    {0x734, 0xf},
    {0x736, 0xfffffffffff},
    {0x737, 0xfffffffffff},
    {0x738, 0xfffffffffff},
    {0x739, 0xfffffffffff},
    {0x740, 0x1fdcffff},
    {0x741, 0x1fdcffff},
    {0x742, 0x1fdcffff},
    {0x743, 0x1fdcffff},
    {0x744, 0xf},
    {0x746, 0xfffffffffff},
    {0x747, 0xfffffffffff},
    {0x748, 0xfffffffffff},
    {0x749, 0xfffffffffff},
    {0x750, 0x1fdcffff},
    {0x751, 0x1fdcffff},
    {0x752, 0x1fdcffff},
    {0x753, 0x1fdcffff},
    {0x754, 0xf},
    {0x756, 0xfffffffffff},
    {0x757, 0xfffffffffff},
    {0x758, 0xfffffffffff},
    {0x759, 0xfffffffffff},
    {0x760, 0x1fdcffff},
    {0x761, 0x1fdcffff},
    {0x762, 0x1fdcffff},
    {0x763, 0x1fdcffff},
    {0x764, 0xf},
    {0x766, 0xfffffffffff},
    {0x767, 0xfffffffffff},
    {0x768, 0xfffffffffff},
    {0x769, 0xfffffffffff},
    {0x770, 0xffffffffffffffff},
    {0xC90, 0x8000ffff},
    {0xC91, 0x8000ffff},
    {0xC92, 0x8000ffff},
    {0xC93, 0x8000ffff},
    {0xDB0, 0x1},
    {0xE01, 0xe000007f},
};

// For sanity check
static const struct msr_mask msr_list_labXX[] = {
    {0xc0011029, 0xffffffff},
};

#ifdef __cplusplus
}
#endif
#endif
