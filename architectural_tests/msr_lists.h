#ifndef MSR_LISTS_H
#define MSR_LISTS_H
#ifdef __cplusplus
extern "C" {
#endif

#define MSR_LIST msr_list_amd_zen4
struct msr_mask {
    unsigned long msr;
    unsigned long mask;
};

static const struct msr_mask msr_list_amd_zen4[] = {
    {0xC0000108, 0x2F},
    // QoS
    // {0xC0000200, 0xFFF},
    // {0xC0000201, 0xFFF},
    // {0xC0000202, 0xFFF},
    // {0xC0000203, 0xFFF},
    // {0xC0000204, 0xFFF},
    // {0xC0000205, 0xFFF},
    // {0xC0000206, 0xFFF},
    // {0xC0000207, 0xFFF},
    // {0xC0000208, 0xFFF},
    // {0xC0000209, 0xFFF},
    // {0xC000020A, 0xFFF},
    // {0xC000020B, 0xFFF},
    // {0xC000020C, 0xFFF},
    // {0xC000020D, 0xFFF},
    // {0xC000020E, 0xFFF},
    // {0xC000020F, 0xFFF},
    // {0xC0000200, 0xFFF},
    // {0xC0000280, 0xFFF},
    // {0xC0000281, 0xFFF},
    // {0xC0000282, 0xFFF},
    // {0xC0000283, 0xFFF},
    // {0xC0000284, 0xFFF},
    // {0xC0000285, 0xFFF},
    // {0xC0000286, 0xFFF},
    // {0xC0000287, 0xFFF},
    // {0xC0000288, 0xFFF},
    // {0xC0000289, 0xFFF},
    // {0xC000028A, 0xFFF},
    // {0xC000028B, 0xFFF},
    // {0xC000028C, 0xFFF},
    // {0xC000028D, 0xFFF},
    // {0xC000028E, 0xFFF},
    // {0xC000028F, 0xFFF},

    {0xC0000400, 0x7F},
    {0xC0000401, 0x7F},
    {0xC0000410, 0x1FFF0FE},

    {0xC0002005, 0x100},
    {0xC0002015, 0x100},
    {0xC0002025, 0x100},
    {0xC0002035, 0x100},
    {0xC0002055, 0x100},
    {0xC0002065, 0x100},
    // {0xC0010058, 0xFFFFFFFF0001D}, // CRASH , segmentation fault
    // {0xC0010062, 0x2},
    {0xC0010064, 0xFFFFFFFFFFFFF778},
    {0xC0010065, 0xFFFFFFFFFFFFF77F},
    {0xC0010066, 0xFFFFFFFFFFFFF77F},
    // {0xC0010067, 0xFFFFFFFFFFFFDF00},
    // {0xC0010068, 0xFFFFFFFFFFFFDF00},
    // {0xC0010069, 0xFFFFFFFFFFFFDF00},
    // {0xC001006A, 0xFFFFFFFFFFFFDF00},
    // {0xC001006B, 0xFFFFFFFFFFFFDF00},
    {0xC0010074, 0x3FF},
    {0xC0010113, 0xC},
    {0xC0010230, 0xF07DC000040FFFF},
    // {0xC0010231, 0x1FFFFFFFFFFFF},
    // {0xC0010232, 0xF07DC000040FFFF},
    // {0xC0010233, 0x1FFFFFFFFFFFF},
    // {0xC0010234, 0xF07DC000040FFFF},
    // {0xC0010235, 0x1FFFFFFFFFFFF},
    // {0xC0010236, 0xF07DC000040FFFF},
    // {0xC0010237, 0x1FFFFFFFFFFFF},
    // {0xC0010238, 0xF07DC000040FFFF},
    // {0xC0010239, 0x1FFFFFFFFFFFF},
    // {0xC001023A, 0xF07DC000040FFFF},
    // {0xC001023B, 0x1FFFFFFFFFFFF},

    // NB PMC from what I found
    // {0xC0010240, 0xFFFFFF3F0F78FFFF},
    // {0xC0010241, 0xFFFFFFFFFFFF},
    // {0xC0010242, 0xFFFFFF3F0F78FFFF},
    // {0xC0010243, 0xFFFFFFFFFFFF},
    // {0xC0010244, 0xFFFFFF3F0F78FFFF},
    // {0xC0010245, 0xFFFFFFFFFFFF},
    // {0xC0010246, 0xFFFFFF3F0F78FFFF},
    // {0xC0010247, 0xFFFFFFFFFFFF},
    // {0xC0010248, 0xFFFFFF3F0F78FFFF},
    // {0xC0010249, 0xFFFFFFFFFFFF},
    // {0xC001024A, 0xFFFFFF3F0F78FFFF},
    // {0xC001024B, 0xFFFFFFFFFFFF},
    // {0xC001024C, 0xFFFFFF3F0F78FFFF},
    // {0xC001024D, 0xFFFFFFFFFFFF},
    // {0xC001024E, 0xFFFFFF3F0F78FFFF},
    // {0xC001024F, 0xFFFFFFFFFFFF},
    // {0xC0010250, 0xFFFFFF3F0F78FFFF},
    // {0xC0010251, 0xFFFFFFFFFFFF},
    // {0xC0010252, 0xFFFFFF3F0F78FFFF},
    // {0xC0010253, 0xFFFFFFFFFFFF},
    // {0xC0010254, 0xFFFFFF3F0F78FFFF},
    // {0xC0010255, 0xFFFFFFFFFFFF},
    // {0xC0010256, 0xFFFFFF3F0F78FFFF},
    // {0xC0010257, 0xFFFFFFFFFFFF},
    // {0xC0010258, 0xFFFFFF3F0F78FFFF},
    // {0xC0010259, 0xFFFFFFFFFFFF},
    // {0xC001025A, 0xFFFFFF3F0F78FFFF},
    // {0xC001025B, 0xFFFFFFFFFFFF},
    // {0xC001025C, 0xFFFFFF3F0F78FFFF},
    // {0xC001025D, 0xFFFFFFFFFFFF},
    // {0xC001025E, 0xFFFFFF3F0F78FFFF},
    // {0xC001025F, 0xFFFFFFFFFFFF},

    {0xC0010292, 0xFFFFFFFF00000000},
    // {0xC0010294, 0x7FFFFFFF3FFFFFFF},
    // {0xC0010296, 0xFFFFFF007F7F7F},

    // UMC PMC stuff
    // {0xC0010800, 0xFFFFFFFF},
    // {0xC0010801, 0x1FFFFFFFFFFFF},
    // {0xC0010802, 0xFFFFFFFF},
    // {0xC0010803, 0x1FFFFFFFFFFFF},
    // {0xC0010804, 0xFFFFFFFF},
    // {0xC0010805, 0x1FFFFFFFFFFFF},
    // {0xC0010806, 0xFFFFFFFF},
    // {0xC0010807, 0x1FFFFFFFFFFFF},
    // {0xC0010808, 0xFFFFFFFF},
    // {0xC0010809, 0x1FFFFFFFFFFFF},
    // {0xC001080A, 0xFFFFFFFF},
    // {0xC001080B, 0x1FFFFFFFFFFFF},
    // {0xC001080C, 0xFFFFFFFF},
    // {0xC001080D, 0x1FFFFFFFFFFFF},
    // {0xC001080E, 0xFFFFFFFF},
    // {0xC001080F, 0x1FFFFFFFFFFFF},

    {0xC0011020, 0xFFFFFFFFFFFFFF7F}, // 0x0000000000000080 This bit sometimes seems to stuck the processor a bit
    {0xC0011021, 0xFFFFFFFFFFFFFFFF},
    {0xC0011022, 0xFFC00007FFFFFFFF},
    {0xC0011023, 0x1EF0000BFFFFFF},
    {0xC0011028, 0xFFFFE0FFFFFFF3FF},
    {0xC0011029, 0xFFFFB17CD3FA7FFC}, // StackWarp
    {0xC001102A, 0xFFFFFFFFFFFFFFFF},
    {0xC001102B, 0xFFFFFFFFFFFFFFFF},
    {0xC001102C, 0xFFFE001FDFF00000},
    {0xC001102D, 0xFFFFFFFFFFFFFFFF},
    {0xC001102E, 0xFFFFFFFFFFFFFFFF},
    {0xC001102F, 0xFFFFFFFFFFF0000E},

    {0xC0011075, 0xFFFFFFFF},
    {0xC0011092, 0xFFFFFFFD},
    {0xC0011093, 0xFEFFFFFF},
    {0xC0011094, 0xFFFFFFFF},
    // {0xC0011095, 0xFFFFFFFFFF000},
    // {0xC0011096, 0xFFFFFFFFFF001},
    {0xC0011097, 0xFFFF7FFF},
    {0xC0011098, 0x603FF},
    {0xC0011099, 0x1FFFF},
    // {0xC001109A, 0xFFFF}, // Cache Reservation used by SNPeek

    {0xC00110E2, 0xFFFFFFFFFFFFFFFF},
    {0xC00110E3, 0xFFFFFFFFFFFFFDDF},
    {0xC00110E4, 0xFFFFFFFFFFFFFFFF},
    {0xC00110E5, 0xFFFFFFFFFFFFFFFF},
    {0xC00110E6, 0xFFFFFFFFFFFF},
    {0xC00110E7, 0x3FF},
    {0xC00110E8, 0x1FFFFFFFFF},
    {0xC00110E9, 0xFFFFFFFF},
    {0xC00110EA, 0xFFFFFFFF},
    {0xC00110EB, 0xFFFFFFFFFFFFFFFF},
    {0xC00110EC, 0x7FFFFFF},
};

static const struct msr_mask msr_list_intel_coffee_lake[] = {
    {0x0, 0xfff},
    {0x33, 0x80000000},
    {0x95, 0x1},
    {0xE2, 0xfe00040f & ~(1ul << 15)},
    {0xE4, 0x7ffff},
    {0x102, 0x80007fff},
    {0x103, 0xff},
    {0x11F, 0xffffffffffffffff},
    {0x150, 0x8000000000000000},
    {0x194, 0xfffffffffff1ffff},
    {0x198, 0xf7fffffdffff7fee},
    {0x19B, 0x1ffff17},
    {0x1A0, 0x4000010008},
    {0x1A2, 0xffffffffbf0000ff},
    {0x1A4, 0x80f},
    {0x1AA, 0x401481},
    {0x1B2, 0x1ffff17},
    {0x1FC, 0xffffffffffffffdf},
    /* Evil MTRR stuff
    {0x200, 0x7ffffff005},
    {0x201, 0x7ffffff800},
    {0x202, 0x7ffffff005},
    {0x203, 0x7ffffff800},
    {0x204, 0x7ffffff005},
    {0x205, 0x7ffffff800},
    {0x206, 0x7ffffff005},
    {0x207, 0x7ffffff800},
    {0x208, 0x7ffffff005},
    {0x209, 0x7ffffff800},
    {0x20A, 0x7ffffff005},
    {0x20B, 0x7ffffff800},
    {0x20C, 0x7ffffff005},
    {0x20D, 0x7ffffff800},
    {0x20E, 0x7ffffff005},
    {0x20F, 0x7ffffff800},
    {0x210, 0x7ffffff005},
    {0x211, 0x7ffffff800},
    {0x212, 0x7ffffff005},
    {0x213, 0x7ffffff800},
    */
    {0x250, 0x202020202020202},
    {0x258, 0x202020202020202},
    {0x259, 0x505050505050505},
    {0x268, 0x505050505050505},
    {0x269, 0x505050505050505},
    {0x26A, 0x505050505050505},
    {0x26B, 0x505050505050505},
    {0x26C, 0x505050505050505},
    {0x26D, 0x505050505050505},
    {0x26E, 0x505050505050505},
    {0x26F, 0x505050505050505},
    {0x280, 0x40007fff},
    {0x281, 0x40007fff},
    {0x282, 0x40007fff},
    {0x283, 0x40007fff},
    {0x286, 0x40007fff},
    {0x287, 0x40007fff},
    {0x288, 0x40007fff},
    {0x289, 0x40007fff},
    {0x28A, 0x40007fff},
    {0x28B, 0x40007fff},
    {0x2FF, 0xc02}, // MTRR
    {0x302, 0xfffffffffffe0000},
    {0x394, 0x500000},
    {0x395, 0xffffffffffff},
    {0x397, 0xf},
    {0x3B0, 0xfffffffffff},
    {0x3B1, 0xfffffffffff},
    {0x3B2, 0x1fdcffff},
    {0x3B3, 0x1fdcffff},

    {0x400, 0xfff},
    {0x404, 0xf},
    {0x408, 0xf},
    {0x40C, 0x1f},
    {0x410, 0x3f},
    {0x414, 0x1},
    {0x418, 0xff},
    {0x41C, 0xff},
    {0x420, 0xff},
    {0x424, 0xff},
    {0x428, 0xff},
    {0x42C, 0xff},

    {0x4E2, 0xffffffffffffff86},
    {0x561, 0x4000000000},
    {0x571, 0x1000000000},
    {0x601, 0xffffffff80001fff},
    {0x603, 0x7fffffffffffff},
    {0x607, 0x1fffffff},
    {0x608, 0xffffffff},
    {0x60A, 0x9fff},
    {0x60B, 0x9fff},
    {0x60C, 0x9fff},
    {0x610, 0x80ffffff00ff7fff & ~(1ul << 63)},
    {0x611, 0xff80000000000000},
    {0x620, 0x7f7f},
    {0x622, 0x1},
    {0x633, 0x9fff},
    {0x634, 0x9fff},
    {0x635, 0x9fff},
    {0x636, 0xffff},
    {0x638, 0xffffffff80ffffff & ~(1ul << 31)},
    {0x639, 0xfbfb7feffdbffdbe},
    {0x63A, 0x1f},
    {0x640, 0xffffffff80ffffff},
    {0x642, 0x1f},
    {0x64F, 0xfffffffff0000000},
    {0x652, 0x7fff7ff},
    {0x65C, 0x8001ffff00ffffff},
    {0x700, 0x1fdcffff},
    {0x701, 0x1fdcffff},
    {0x702, 0x1fdcffff},
    {0x703, 0x1fdcffff},
    {0x704, 0xf},
    {0x706, 0xfffffffffff},
    {0x707, 0xfffffffffff},
    {0x708, 0xfffffffffff},
    {0x709, 0xfffffffffff},
    {0x710, 0x1fdcffff},
    {0x711, 0x1fdcffff},
    {0x712, 0x1fdcffff},
    {0x713, 0x1fdcffff},
    {0x714, 0xf},
    {0x716, 0xfffffffffff},
    {0x717, 0xfffffffffff},
    {0x718, 0xfffffffffff},
    {0x719, 0xfffffffffff},
    {0x720, 0x1fdcffff},
    {0x721, 0x1fdcffff},
    {0x722, 0x1fdcffff},
    {0x723, 0x1fdcffff},
    {0x724, 0xf},
    {0x726, 0xfffffffffff},
    {0x727, 0xfffffffffff},
    {0x728, 0xfffffffffff},
    {0x729, 0xfffffffffff},
    {0x730, 0x1fdcffff},
    {0x731, 0x1fdcffff},
    {0x732, 0x1fdcffff},
    {0x733, 0x1fdcffff},
    {0x734, 0xf},
    {0x736, 0xfffffffffff},
    {0x737, 0xfffffffffff},
    {0x738, 0xfffffffffff},
    {0x739, 0xfffffffffff},
    {0x740, 0x1fdcffff},
    {0x741, 0x1fdcffff},
    {0x742, 0x1fdcffff},
    {0x743, 0x1fdcffff},
    {0x744, 0xf},
    {0x746, 0xfffffffffff},
    {0x747, 0xfffffffffff},
    {0x748, 0xfffffffffff},
    {0x749, 0xfffffffffff},
    {0x750, 0x1fdcffff},
    {0x751, 0x1fdcffff},
    {0x752, 0x1fdcffff},
    {0x753, 0x1fdcffff},
    {0x754, 0xf},
    {0x756, 0xfffffffffff},
    {0x757, 0xfffffffffff},
    {0x758, 0xfffffffffff},
    {0x759, 0xfffffffffff},
    {0x760, 0x1fdcffff},
    {0x761, 0x1fdcffff},
    {0x762, 0x1fdcffff},
    {0x763, 0x1fdcffff},
    {0x764, 0xf},
    {0x766, 0xfffffffffff},
    {0x767, 0xfffffffffff},
    {0x768, 0xfffffffffff},
    {0x769, 0xfffffffffff},
    {0x770, 0xffffffffffffffff},
    {0xC90, 0x8000ffff},
    {0xC91, 0x8000ffff},
    {0xC92, 0x8000ffff},
    {0xC93, 0x8000ffff},
    {0xDB0, 0x1},
    {0xE01, 0xe000007f},
};

static const struct msr_mask msr_list_stackwarp[] = {
    {0xc0011029, 0x80000},
};

static const struct msr_mask jitter_blacklist[] = {
};

#ifdef __cplusplus
}
#endif
#endif
